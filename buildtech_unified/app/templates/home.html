<!-- app/templates/home.html -->
{% extends 'base.html' %}

{% block content %}
<div class="container">
    <!-- Header de Bienvenida -->
    <div class="welcome-header">
        <h1>ğŸ  Bienvenido, {{ current_user.first_name }}!</h1>
        <p class="text-muted">
            {% if current_user.has_role('admin') %}
                Panel de AdministraciÃ³n del Edificio
            {% else %}
                Departamento {{ current_user.departamento }}
            {% endif %}
        </p>
    </div>
    
    <!-- Dashboard segÃºn Rol -->
    {% if current_user.has_role('admin') %}
    <!-- ============= DASHBOARD ADMINISTRADOR ============= -->
    <div class="dashboard-grid">
        <div class="dashboard-card card-mantenimiento">
            <div class="card-icon">âš™ï¸</div>
            <h3>Mantenimiento</h3>
            <p>Gestiona tickets y solicitudes de mantenimiento del edificio</p>
            <div class="card-stats">
                <span class="stat-badge">ğŸ“Š Ver EstadÃ­sticas</span>
            </div>
            <div class="card-actions">
                <a href="{{ url_for('mantenimiento.list_mantenimiento') }}" class="btn btn-primary">
                    Ver Tickets
                </a>
                <a href="{{ url_for('mantenimiento.create_ticket') }}" class="btn btn-outline-primary">
                    Crear Nuevo
                </a>
            </div>
        </div>
        
        <div class="dashboard-card card-comunicacion">
            <div class="card-icon">ğŸ’¬</div>
            <h3>ComunicaciÃ³n</h3>
            <p>Chat, avisos importantes y sistema de quejas de residentes</p>
            <div class="card-stats">
                <span class="stat-badge">ğŸ”” Notificaciones Activas</span>
            </div>
            <div class="card-actions">
                <a href="{{ url_for('comunicacion.avisos') }}" class="btn btn-success">
                    Ver Avisos
                </a>
                <a href="{{ url_for('comunicacion.quejas') }}" class="btn btn-outline-success">
                    Ver Quejas
                </a>
            </div>
        </div>
        
        <div class="dashboard-card card-finanzas">
            <div class="card-icon">ğŸ’°</div>
            <h3>Finanzas</h3>
            <p>Control de pagos, cargos mensuales y gastos del edificio</p>
            <div class="card-stats">
                <span class="stat-badge">ğŸ’µ Balance Mensual</span>
            </div>
            <div class="card-actions">
                <a href="{{ url_for('finanzas.resumen_financiero') }}" class="btn btn-warning">
                    Ver Resumen
                </a>
            </div>
        </div>
        
        <div class="dashboard-card card-reservas">
            <div class="card-icon">ğŸ“…</div>
            <h3>Reservas</h3>
            <p>Administrar reservas de Ã¡reas comunes y espacios del edificio</p>
            <div class="card-stats">
                <span class="stat-badge">ğŸ« Reservas Activas</span>
            </div>
            <div class="card-actions">
                <a href="{{ url_for('reservas.reservas_admin') }}" class="btn btn-info">
                    Administrar
                </a>
                <a href="{{ url_for('reservas.reservas') }}" class="btn btn-outline-info">
                    Nueva Reserva
                </a>
            </div>
        </div>
    </div>
    
    {% else %}
    <!-- ============= DASHBOARD RESIDENTE ============= -->
    <div class="dashboard-grid">
        <div class="dashboard-card card-ticket">
            <div class="card-icon">ğŸ”§</div>
            <h3>Reportar Problema</h3>
            <p>Crea un ticket de mantenimiento para reportar problemas en tu departamento o Ã¡reas comunes</p>
            <div class="card-actions">
                <a href="{{ url_for('mantenimiento.create_ticket') }}" class="btn btn-primary btn-lg">
                    â• Crear Ticket
                </a>
                <a href="{{ url_for('mantenimiento.list_mantenimiento') }}" class="btn btn-outline-primary">
                    Ver Mis Tickets
                </a>
            </div>
        </div>
        
        <div class="dashboard-card card-reserva">
            <div class="card-icon">ğŸ“…</div>
            <h3>Reservar Ãrea</h3>
            <p>Reserva salones de fiestas, Ã¡reas de parrilla, piscina y mÃ¡s espacios comunes</p>
            <div class="card-actions">
                <a href="{{ url_for('reservas.reservas') }}" class="btn btn-success btn-lg">
                    ğŸ“ Hacer Reserva
                </a>
            </div>
        </div>
        
        <div class="dashboard-card card-pagos">
            <div class="card-icon">ğŸ’³</div>
            <h3>Mis Pagos</h3>
            <p>Consulta tus cargos mensuales, servicios y realiza pagos pendientes</p>
            <div class="card-actions">
                {% if current_user.departamento %}
                <a href="{{ url_for('finanzas.calcular_cargos_mensuales', departamento_id=current_user.departamento) }}" 
                   class="btn btn-warning btn-lg">
                    ğŸ’° Ver Cargos
                </a>
                {% else %}
                <button class="btn btn-secondary btn-lg" disabled>
                    Sin Departamento Asignado
                </button>
                {% endif %}
            </div>
        </div>
        
        <div class="dashboard-card card-chat">
            <div class="card-icon">ğŸ’¬</div>
            <h3>ComunicaciÃ³n</h3>
            <p>Chat general del edificio, avisos importantes y envÃ­a sugerencias o quejas</p>
            <div class="card-actions">
                <a href="{{ url_for('comunicacion.chat_general') }}" class="btn btn-info btn-lg">
                    ğŸ’¬ Ir al Chat
                </a>
                <a href="{{ url_for('comunicacion.avisos') }}" class="btn btn-outline-info">
                    Ver Avisos
                </a>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- SecciÃ³n de Acceso RÃ¡pido -->
    <div class="quick-access mt-5">
        <h4>âš¡ Acceso RÃ¡pido</h4>
        <div class="quick-links">
            <a href="{{ url_for('comunicacion.chat_general') }}" class="quick-link">
                <span class="icon">ğŸ’¬</span>
                <span class="text">Chat General</span>
            </a>
            <a href="{{ url_for('comunicacion.quejas') }}" class="quick-link">
                <span class="icon">ğŸ“</span>
                <span class="text">Quejas/Sugerencias</span>
            </a>
            <a href="{{ url_for('comunicacion.avisos') }}" class="quick-link">
                <span class="icon">ğŸ“¢</span>
                <span class="text">Avisos</span>
            </a>
            {% if current_user.has_role('admin') %}
            <a href="{{ url_for('comunicacion.notificaciones') }}" class="quick-link">
                <span class="icon">ğŸ””</span>
                <span class="text">Notificaciones</span>
            </a>
            {% endif %}
        </div>
    </div>
</div>

<style>
.welcome-header {
    text-align: center;
    padding: 2rem 0;
    margin-bottom: 3rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 16px;
    color: white;
}

.welcome-header h1 {
    font-size: 2.5rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

.dashboard-card {
    background: white;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transition: transform 0.3s, box-shadow 0.3s;
    border-left: 5px solid;
}

.dashboard-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
}

.card-mantenimiento { border-left-color: #3498db; }
.card-comunicacion { border-left-color: #27ae60; }
.card-finanzas { border-left-color: #f39c12; }
.card-reservas { border-left-color: #17a2b8; }
.card-ticket { border-left-color: #e74c3c; }
.card-reserva { border-left-color: #9b59b6; }
.card-pagos { border-left-color: #f39c12; }
.card-chat { border-left-color: #3498db; }

.card-icon {
    font-size: 4rem;
    text-align: center;
    margin-bottom: 1rem;
}

.dashboard-card h3 {
    font-size: 1.5rem;
    color: #2c3e50;
    margin-bottom: 1rem;
}

.dashboard-card p {
    color: #666;
    margin-bottom: 1.5rem;
    line-height: 1.6;
}

.card-stats {
    margin-bottom: 1.5rem;
}

.stat-badge {
    display: inline-block;
    padding: 0.5rem 1rem;
    background: #f8f9fa;
    border-radius: 20px;
    font-size: 0.85rem;
    color: #666;
}

.card-actions {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.card-actions .btn {
    flex: 1;
    min-width: 120px;
}

.quick-access {
    background: white;
    padding: 2rem;
    border-radius: 16px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.quick-access h4 {
    margin-bottom: 1.5rem;
    color: #2c3e50;
}

.quick-links {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
}

.quick-link {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1.5rem;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 12px;
    text-decoration: none;
    color: #2c3e50;
    transition: all 0.3s;
}

.quick-link:hover {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    transform: scale(1.05);
}

.quick-link .icon {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
}

.quick-link .text {
    font-size: 0.9rem;
    font-weight: 600;
    text-align: center;
}

@media (max-width: 768px) {
    .welcome-header h1 {
        font-size: 1.8rem;
    }
    
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
    
    .card-actions {
        flex-direction: column;
    }
    
    .card-actions .btn {
        width: 100%;
    }
    
    .quick-links {
        grid-template-columns: repeat(2, 1fr);
    }
}
</style>
{% endblock %}